Test cases in ros
=================

This wiki will help you to create test cases for your software components.

Motivation: this is usefull for both development and functionallity improvement plus shows 
that your component works correctly under different circumstances.

Lets suppose you write your code and it works awesome. Later on you want to improve the functionallity or
refactor the components, then you can run a test on your improved code and should return positive result then
this means that the changes you have made they dont break your code.

To write the test case is easy, you basically define a expected result, then your component return also a result
which gets compared to the return value by using the function:

        self.assertEqual(result, expected, msg='result:\n{0}\n\nexpected:\n{1}'.format(result, expected))

once the motivation is explained lets start: 
       
1. Write your test class under ros/test folder
        
    notice that the test class does not need to be executable

2. a setup.py (not executable) file needs to live in the root of your ros package at the same level of CMakeLists.txt and package.xml
with the following information inside:

        #!/usr/bin/env python

        from distutils.core import setup
        from catkin_pkg.python_setup import generate_distutils_setup

        d = generate_distutils_setup(
            packages=['my_package_name', 'my_package_name_ros'], 
            package_dir={'my_package_name': 'common/src', 'my_package_name_ros': 'ros/src'}
        )

        setup(**d)
        
3. install dependencies:

        sudo pip install -U pytest

4. include the following line in your CMakeLists.txt:

        catkin_python_setup()     ...before catkin_package

5. your folder structure should look something like this:

        ├── CMakeLists.txt
        ├── common
        │   └── src
        │       └── my_package_name
        │           ├── __init__.py
        │           └── my_generic_util_class.py
        ├── package.xml
        ├── ros
        │   ├── config
        │   │   └── my_arg_file.yaml
        │   ├── doc
        │   │   └── README.md
        │   ├── launch
        │   │   └── my_node_launchfile.launch
        │   ├── scripts
        │   │   └── my_node_name
        │   ├── src
        │   │   └── my_package_name
        │   │       ├── __init__.py
        │   │       └── my_node_implementation.py
        │   └── test
        │       └── pddl_object_upload_test.py
        └── setup.py
        
        NOTE: __pycache__ folder and .pyc files are autogenerated, you dont need to put them 
        NOTE: the only file which needs to be executable is my_ros_node
       
6. do catkin_make, although python is not compiled language it does add some stuff to your PYTHONPATH when you execute this command
       
7. run your test from your ros/test folder by executing the command:

        py.test my_test.py